\chapter{Méthodes approchées}\label{chapapprox}
\markboth{\uppercase{Méthodes approchées}}{\uppercase{Méthodes approchées}}

\minitoc

\section{Introduction}

Dans le chapitre précédent nous avons présenté la DDA par une approche
simplifié où l'objet est un ensemble de petits dipôles rayonnant. Dans
une approche plus rigoureuse nous partons des équations de Maxwell en
unité Gaussienne:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \venab \times \ve{E}^{\rm m}(\ve{r}) & = & i \frac{\omega}{c}
\ve{B}(\ve{r}) \\
\venab \times \ve{B}(\ve{r}) & = & -i \frac{\omega}{c}
\varepsilon(\ve{r}) \ve{E}^{\rm m}(\ve{r}), \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
où $\varepsilon(\ve{r})$ est la permittivité relative de l'objet et
$\ve{E}^{\rm m}$ le champ total dans l'objet. Ce qui nous donne
l'équation de propagation suivante pour le champ électrique:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \venab \times ( \venab \times \ve{E}^{\rm m}(\ve{r}) ) & = &
\varepsilon(\ve{r}) k_0^2 \ve{E}^{\rm m}(\ve{r}), \ee 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
avec $k_0=\omega^2/c^2$. En utilisant la relation
$\varepsilon=\varepsilon_{\rm mul}+4\pi \chi$ avec $\chi$ la
susceptibilité linéaire électrique, $\varepsilon_{\rm mul}$ étant la
permittivité relative du multicouche qui ne dépend que de $z$, nous
avons:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \venab \times ( \venab \times \ve{E}^{\rm m}(\ve{r}) )
-\varepsilon_{\rm mul} k_0^2 \ve{E}^{\rm m}(\ve{r}) & = & 4\pi
\chi(\ve{r}) k_0^2 \ve{E}^{\rm m}(\ve{r}) . \label{champref}\ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
La solution de cette équation sans second membre est le champ de
référence et correspond donc au milieu de référence, c'est à dire le
milieu en l'absence de l'objet étudié ($\chi=0$), dans notre cas le
multicouche.  Pour résoudre cette équation avec second membre on
cherche la fonction de Green solution de
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \venab \times ( \venab \times \ve{G}(\ve{r},\ve{r}') )
-\varepsilon_{\rm mul} k_0^2 \ve{G}(\ve{r},\ve{r}') & = & 4\pi k_0^2
\ve{I} \delta(\ve{r}-\ve{r}'), \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
La solution finale est donc:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be\ve{E}^{\rm m}(\ve{r}) = \ve{E}_{\rm ref}(\ve{r}) +\int_{\Omega}
\ve{G}(\ve{r},\ve{r}') \chi(\ve{r}') \ve{E}^{\rm m}(\ve{r}') {\rm d}
\ve{r}',\ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
avec $\ve{E}_{\rm ref}$ le champ de référence solution de
l'Eq.~(\ref{champref}) sans second membre et $\Omega$ le volume
correspondant au support de l'objet étudié. Quand on résout l'équation
dans l'objet, le champ total correspond donc au champ macroscopique
dans l'objet. Pour résoudre cette équation on discrétise l'objet en un
ensemble de $N$ éléments de forme cubique ayant une arête de taille
$d$ et l'intégrale $\Omega$ sur l'objet est donc décomposée en une
somme d'intégrale sur chacun des éléments de discrétisation de volume
$V_j=d^3$:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be\ve{E}^{\rm m}(\ve{r}_i) = \ve{E}_{\rm ref}(\ve{r}_i)
+\sum_{j=1}^{N} \int_{V_j} \ve{G}(\ve{r}_i,\ve{r}') \chi(\ve{r}')
\ve{E}^{\rm m}(\ve{r}') {\rm d} \ve{r}',\ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
En supposant le champ, la fonction Green et la permittivité constants
dans la maille, nous obtenons:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be\ve{E}^{\rm m}(\ve{r}_i) = \ve{E}_{\rm ref}(\ve{r}_i) +\sum_{j=1}^N
\ve{G}(\ve{r}_i,\ve{r}_j) \chi(\ve{r}_j) \ve{E}^{\rm m}(\ve{r}_j)
d^3.\ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Le tenseur de Green peut être coupé en deux parties,
$\ve{G}=\ve{M}+\ve{T}$, avec $\ve{M}$ le tenseur de Green qui prend en
compte les réflexions multiple entre les différentes interfaces et
$\ve{T}$ le tenseur de Green de l'espace homogène.  En utilisant, en
première approximation (c'est à dire que la réaction de rayonnement
est négligée, mais la prendre en compte ne changerait pas les
raisonnements qui suivent), le fait que que
$\int_{V_i}\ve{T}(\ve{r}_i,\ve{r}') {\rm d} \ve{r}'=
-4\pi/(3\varepsilon_{\rm mul}(\ve{r}_i)) $, voir
Ref.~\onlinecite{Yaghjian_PIEEE_80}) pour plus de détails, nous avons:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be\ve{E}^{\rm m}(\ve{r}_i) = \ve{E}_{\rm ref}(\ve{r}_i) +\sum_{j=1}^N
\ve{G}'(\ve{r}_i,\ve{r}_j) \chi(\ve{r}_j) d^3 \ve{E}^{\rm
  m}(\ve{r}_j)-\frac{4\pi}{3\varepsilon_{\rm
    mul}(\ve{r}_i)}\chi(\ve{r}_i) \ve{E}^{\rm m}(\ve{r}_i),\ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
avec $\ve{G}'=\ve{M}+\ve{T}$ pour $i \neq j$ et $\ve{G}'=\ve{M}$ pour
$i=j$, et en passant toutes les dépendances en $i$ à gauche de la relation
nous avons au final:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be\ve{E}(\ve{r}_i) & = & \ve{E}_{\rm ref}(\ve{r}_i) +\sum_{j=1}^N
\ve{G}'(\ve{r}_i,\ve{r}_j) \alpha_{\rm CM}(\ve{r}_j) \ve{E}(\ve{r}_j)
\\ {\rm with} \phantom{000} \ve{E}(\ve{r}_i) & = &
\frac{\varepsilon(\ve{r}_i)+2\varepsilon_{\rm
    mul}(\ve{r}_i)}{3\varepsilon_{\rm mul}(\ve{r}_i)} \ve{E}^{\rm
  m}(\ve{r}_i) \\ \alpha_{\rm CM}(\ve{r}_j) & = & \frac{3}{4\pi}
\varepsilon_{\rm mul}(\ve{r}_i) d^3
\frac{\varepsilon(\ve{r}_i)-\varepsilon_{\rm
    mul}(\ve{r}_i)}{\varepsilon(\ve{r}_i)+2\varepsilon_{\rm
    mul}(\ve{r}_i)} .\ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Le champ $\ve{E}(\ve{r}_i)$ est le champ local, c'est à dire que c'est
le champ dans la maille $i$ en l'absence de la maille elle même. En
écrivant cette équation pour toutes les valeurs de $i$ nous avons un
système d'équations linéaires que nous pouvons écrire symboliquement
comme:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{E} = \ve{E}_{\rm ref} + \ve{A} \ve{D}_\alpha \ve{E},\ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
avec $\ve{A}$ qui contient toutes les fonctions de Green et
$\ve{D}_\alpha$ une matrice diagonale qui contient toutes les
polarisabilités de chaque élément de discrétisation. Nous détaillons
au chapitre suivant comment résoudre rigoureusement ce système
d'équation linéaire, mais dans ce présent chapitre nous détaillons les
différentes approches possibles pour éviter la résolution du système
qui est très gourmande en temps de calcul.

A noter que le champ diffracté par l'objet en dehors du support de
l'objet s'écrit simplement comme:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be\ve{E}^{\rm d}(\ve{r}) & = & \sum_{j=1}^N \ve{G}(\ve{r},\ve{r}_j)
\alpha(\ve{r}_j) \ve{E}(\ve{r}_j). \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{Les différentes méthodes approchées utilisées dans le code}


\subsection{Born}


Une approximation simple est l'approximation de Born, c'est à dire que
le champ macroscopique dans l'objet est le champ incident. Nous avons
donc :
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{E}^{\rm m}(\ve{r}_i) = \ve{E}_{\rm ref}(\ve{r}_i), \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
pour tous les éléments de discrétisation. Après il suffit de faire
propager le champ. Il est évident que cette approximation tient si le
contraste et la taille de l'objet sont petits.


\subsection{Born renormalisé}

Nous pouvons faire l'hypothèse à l'identique mais sur le champ local,
c'est à dire que :
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{E}(\ve{r}_i) = \ve{E}_{\rm ref}(\ve{r}_i). \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
En considérant la relation entre le champ local et le champ
macroscopique nous avons alors:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be  \ve{E}^{\rm m}(\ve{r}_i) = \frac{3}{\varepsilon(\ve{r}_i)+2}
\ve{E}_{\rm ref}(\ve{r}_i). \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
La phase est la même que dans le cas de l'approximation de Born mais
l'amplitude est changée. Cette approximation est meilleure pour des
permittivités plus fortes car fait une correction sur l'amplitude du
champ macroscopique, nous avons appelé cette approximation Born
renormalisé.


\subsection{Born à l'ordre 1}

Sans résoudre le système d'équations linéaires on peut faire un Born
renormalisé à l'ordre 1, c'est à dire que l'on effectue:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be\ve{E}(\ve{r}_i) & = & \ve{E}_{\rm ref}(\ve{r}_i) +\sum_{j=1}^N
\ve{G}'(\ve{r}_i,\ve{r}_j) \alpha(\ve{r}_j) \ve{E}_{\rm
  ref}(\ve{r}_j). \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Ceci permet de prendre en compte un peu la variation du champ dans
l'objet et permet de traiter des objets plus grands mais toujours avec
un contraste faible. Il est possible de développer Born à des ordres
supérieurs mais quand le contraste devient fort la série ne converge
plus...

\section{Calcul des fonctions de Green}

Bien que nous utilisions une méthode très efficace de calcul du
tenseur de Green, voir Ref.~\onlinecite{Paulus_PRE_00}, cela prend
quand même du temps d'évaluer toutes les couples observations dipôles
constituant l'objet. Pour accélérer le calcul nous allons utiliser
l'invariance translationelle dans le plan $(x,y)$ du système
multicouche, soit
$\ve{G}(\ve{r},\ve{r}')=\ve{G}(\|\ve{r}_{\parallel}-\ve{r}_{\parallel}'\|,z,z')$. Pour
chaque couple $(z,z')$, le nombre de tenseur de Green à évaluer pour
tous les distances dans le plan $(x,y)$ avec un maillage de
$ n_x \times n_y$ avec $n_x>n_y$ est égal à $n_y(2 n_x-n_y+1)/2$, ce
qui croît en $n_x^2$. Pour accélérer le calcul, nous pouvons approcher
le tenseur de Green
$\ve{G}(\|\ve{r}_{\parallel}-\ve{r}_{\parallel}'\|,z,z')$ en utilisant
une interpolation sur un ensemble de points tels que
$\ve{G}(qd/n_d,z,z')$ avec $q=1,\cdots, {\rm int}\sqrt{ n_x^2+n_y^2}$
et $n_d$ un nombre entier. Cette fois-ci le nombre de tenseur de Green
à évaluer est proportionnel à $n_d n_x$ ce qui est beaucoup moins
gourmand en temps de calcul et tous les couples observations dipôles
sont alors estimés par interpolation à partir du jeu de donnée
initial.



Notons que les interpolations linéaires ou polynomiales ne peuvent
évaluer le tenseur de Green correctement quand
$\|\ve{r}_{\parallel}-\ve{r}_{\parallel}'\|<\lambda$, du fait de la
décroissance rapide des ondes évanescentes. Pour obtenir une meilleure
interpolation nous avons utiliser des fonctions rationnelles qui permet
de prendre compte des pôles (Press et al. 1986) et permet une
approximation précise du comportement en $1/r^3$ du tenseur de Green
dans la zone de champ proche.



Dans le code, dans la section paramètre numérique, le menu déroulant
Green fonction permet de choisir soit de calculer rigoureusement le
tenseur de Green, soit à partir d'interpolation plus ou moins fine
suivant la valeur de $n_d=1, 2, 3, 4$. Par défaut la valeur $n_d=2$
est utilisée ce qui est suffisamment précis. Notons que le calcul des
tenseurs de Green par interpolation est parallélisé ce qui n'est pas le
cas du calcul rigoureux, soit encore un gain de temps
appréciable.
