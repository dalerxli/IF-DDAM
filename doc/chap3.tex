\chapter{Propriétés de l'illumination}\label{chap3}
\markboth{\uppercase{Propriétés de
    l'illumination}}{\uppercase{Propriétés de l'illumination}}

\minitoc

\section{Introduction}

Dans la section propriétés de l'illumination, le champ {\it
  Wavelength} permet de rentrer la longueur d'utilisation. Celle-ci se
rentre en nanomètre. Le champ $P_0$ permet de rentrer la puissance du
faisceau laser en Watt.  Le champ $W_0$ en nanomètre permet de rentrer
pour une onde plane le rayon du faisceau laser et pour un faisceau
Gaussien la col du faisceau. A noter que dans ce code que l'onde
incidente se propage toujours dans la direction des $z$ positifs, soit
$k_z>0$ quelque soit le type de faisceau choisi.


\section{Le type de faisceau}

\subsection{Introduction}

Il y a six faisceau prédéfinis, leur direction de propagation est
toujours définie de la même manière, avec deux angles $\theta$ et
$\varphi$. Ils sont reliés à la direction donnée par le vecteur d'onde
de la manière suivante:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be k_x & = & k_0 \sin \theta \cos\varphi \\
k_y & = & k_0 \sin \theta \sin\varphi \\
k_z & = & k_0 \cos \theta \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
où $\ve{k}_0=(k_x,k_y,k_z)$ est le vecteur d'onde parallèle à la
direction du faisceau incident et $k_0$ le nombre d'onde, voir
Fig.~\ref{faisceau}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[H]
\begin{center}
  \includegraphics*[width=8.0cm,draft=false]{faisceau.eps}
\end{center}
\caption{Définition de la direction du faisceau}
\label{faisceau}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Pour la polarisation on utilise le plan $(x,y)$ comme surface de
référence. Alors on peut définir une polarisation TM ($p$) et TE
($s$), voir Fig.~\ref{pola}, ou une polarisation suivant l'axe $x$ ou
$y$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[H]
\begin{center}
  \includegraphics*[width=8.0cm,draft=false]{pola.eps}
\end{center}
\caption{Définition de la polarisation du faisceau.}
\label{pola}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Le repère $(x,y,z)$ sert de référentiel absolu par rapport auquel les
différents éléments (illumination plus objets) sont repérés.  Nous
définissons le vecteur polarisation $\ve{s}$ correspondant à la
polarisation $TE$ et le vecteur $\ve{p}$ correspondant à $TM$ comme:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{s} & = & \frac{\hat{\ve{z}} \times \ve{k}_0}{\| \hat{\ve{z}}
  \times \ve{k}_0\|} \\
\ve{p} & = & \frac{\ve{k}_0 \times \ve{s}}{\|\ve{k}_0 \times \ve{s}\|}
.  \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Linear plane wave}

{\it Linear plane wave } est une onde plane polarisée linéairement. La
première ligne est relative à $\theta$ et la deuxième à $\varphi$. La
troisième ligne est liée à la polarisation, la valeur pola=1 l'onde
est polarisée en TM et pola=0 en TE défini comme
$\ve{E}_0=E_p \ve{p} +E_s\ve{s}$ avec $E_p={\rm pola}$ et
$E_s=\sqrt{1-\rm {pola}^2}$.  A noter que la polarisation n'est pas
forcément purement en TE ou TM: soit ${\rm pola}\in[0~1]$ tel que
$E^2_{\rm TM}={\rm pola}^2E^2$ et $E^2_{\rm TE}=(1-{\rm
  pola}^2)E^2$. Nous avons donc cette valeur entre 0 et 1, mais pour
des raisons simplicités nous avons deux valeurs particulières pola=3
(2) assignées à une polarisation pour un champ orienté tel que
$\ve{E}_0 \cdot \hat{\ve{x}} =0$ ($\ve{E_0 } \cdot \hat{\ve{y}} =0$)
sans que l'utilisateur ait à faire de calcul pour trouver la valeur de
pola.

A noter que la phase est toujours prise nulle à l'origine du repère,
avec ${\rm Irradiance}=P_0/S$ où $S=\pi w_0^2$ est la surface du
faisceau et $E_0=\sqrt{2 {\rm Irradiance}/c/\varepsilon_0}$.

\subsection{Circular plane wave}

{\it Circular plane wave } est une onde plane polarisée
circulairement. La première ligne est relative à $\theta$ et la
deuxième à $\varphi$. La troisième ligne est liée à la polarisation
que l'on peut choisir droite (1) ou gauche (-1).

A noter que la phase est prise nulle à l'origine du repère, avec ${\rm
  Irradiance}=P_0/S$ où $S=\pi w_0^2$ est la surface du faisceau et
$E_0=\sqrt{2 {\rm Irradiance}/c/\varepsilon_0}$.



\subsection{Multiplane wave}

{\it Multiplane wave} consiste à choisir comme illumination
différentes onde planes cohérentes. Il faut d'abord choisir le nombre
d'onde plane désiré, puis pour chacune des ondes planes, il faut
choisir son incidence et sa polarisation.  Dans ce cas, il faut
choisir aussi son amplitude complexe ce qui permet de déphaser les
ondes planes les unes par rapport aux autres. La somme de la puissance
de chacune des ondes planes est égales à $P_0$, et chaque puissance
associée à une onde plane est calculée proportionnellement à son
amplitude. A noter que si une amplitude est nulle alors le code
s'arrête.

\subsection{Linear Gaussian}

{\it Linear Gaussian} est une onde gaussienne polarisée
linéairement. La première ligne est relative à $\theta$ et la deuxième
à $\varphi$ qui définissent la direction incidente du faisceau
Gaussien. La troisième ligne est l'angle en degré entre le vecteur
polarisation et l'axe $x$. Si cet angle est égale à zéro alors la
polarisation est suivant $x$, si il est égal à 90 alors la polarisation
est suivant $y$.

Les trois lignes suivantes permettent de fixer la position
$(x_0,y_0,z_0)$ du centre du col en nanomètres dans le repère
$(x,y,z)$.

A noter que cette onde Gaussienne peut avoir un col très faible, car
elle est calculée sans aucune approximation à travers un spectre
d'onde plane fait par FFT. La définition du col est la suivante, pour
un faisceau de propageant suivant l'axe $z$:\cite{Agrawal_JOSA_79}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be E(x,y,0)= E_0 e^{-\rho^2/(2 w_0^2)}, \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
avec $\rho=\sqrt{x^2+y^2}$. A partir de cette définition de
l'amplitude du champ en $z=0$, l'amplitude des composantes de Fourier
est calculée comme:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{A}(k_x,k_y)= E_0 (k_z\ve{i}-k_x\ve{k} )
\frac{1}{\sqrt{k_x^2+k_z^2}} w_0 e^{-(k_x^2+k_y^2)w_0^2/2}, \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
puis l'amplitude, $\ve{A}_{\rm ref} (k_x,k_y,z)$, des composantes de
Fourier dans le système multicouche est calculée, pour au final
accéder au champ de référence dans le multicouche:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{E}_{\rm ref}(x,y,z)= \int \int_{k_0} \ve{A}_{\rm ref} (k_x,k_y,z)
  e^{i(k_x (x-x_0)+k_y (y-y_0)-k_zz_0 )}  {\rm d} \ve{k}_{\parallel}. \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Circular Gaussian} 

{\it Circular Gaussian} est une onde gaussienne polarisée
circulairement. La première ligne est relative à $\theta$ et la
deuxième à $\varphi$.  La troisième ligne est liée à la polarisation
que l'on peut choisir droite (1) ou gauche (-1).


Les trois lignes suivantes permettent de fixer la position du centre
du col  en nanomètres  dans le repère $(x,y,z)$.

Le calcul se fait après comme dans le faisceau Gaussian linéaire mais
avec une quadrature entre la composante $y$ et $x$.


\subsection{Speckle}

{\it Speckle} La speckle est fait comme pour le faisceau Gaussien à
partir d'un spectre d'onde plane mais avec une phase aléatoire. Pour
un speckle polarisé suivant l'axe $x$ la composante de Fourier
s'écrit:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{A}(k_x,k_y)= E_0 (k_z\ve{i}-k_x\ve{k} )
\frac{1}{\sqrt{k_x^2+k_z^2}} e^{i \varphi}, \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
avec $\varphi$ une variable aléatoire entre 0 et $2\pi$. Nous
calculons alors l'amplitude dans le multicouche, $\ve{A}_{\rm ref}
(k_x,k_y,z)$, et le champ de référence s'écrit alors:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\be \ve{E}_{\rm ref}(x,y,z)= \int \int_{k_0 {\rm NA}} \ve{A}_{\rm ref}
(k_x,k_y,z)  e^{i(k_x (x-x_0)+k_y (y-y_0)-k_zz_0 )} {\rm d} \ve{k}_{\parallel}, \ee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
avec ${\rm NA}$ l'ouverture numérique du microscope. $\ve{r}_0$ permet
de faire glisser le speckle dans une direction et la graine permet de
changer la distribution du speckle.

\subsection{Antenne}

Il est possible d'éclairer l'objet par une antenne dipolaire.  Pour
cet éclairement il faut donner l'orientation du dipôle ($\theta$ angle
que fait le dipôle avec l'axe $z$ et $\varphi$ angle que fait la
projection du dipôle sur le plan $(x,y)$ avec l'axe $x$) ainsi que sa
position en $x$, $y$ et $z$.

La localisation du dipôle peut être à l'extérieur de l'objet ou dans
l'objet. Quand l'antenne est dans l'objet, elle est alors placée à la
position d'un élément de discrétisation, le plus proche possible de la
position donnée par l'utilisateur.

La puissance donnée dans le code ($P_0$) correspond alors à la
puissance totale rayonnée par l'antenne.

A noter que le rayonnement d'un dipôle est tel qu'il y a beaucoup
d'énergie rayonnée sur le bord de l'ouverture numérique du
microscope. Il convient donc de prendre beaucoup de points dans
l'ouverture numérique si l'on désire être précis.



De plus il convient de faire très attention à la conservation
d'énergie car celle-ci n'est pas forcément respectée. En effet, un
dipôle qui émet dans le vide 1~W, n'émettra pas 1~W quand celui-ci
sera proche d'un objet ou d'une interface. Par exemple pour la
configuration présentée Fig.~\ref{antenne}(a), la puissance normalisée
est fonction de la distance de l'antenne à l'interface, voir Fig.~
\ref{antenne}(b). En effet la puissance rayonnée par un dipôle n'est
pas une quantité intrinsèque à celui-ci mais dépend de l'environnement
dans lequel il est immergé. Si on trace l'inverse de la puissance
totale rayonnée par le dipôle, c'est proportionnel à la durée de vie
d'un atome fluorescent, voir~ \ref{antenne}(c). Pour plus de détails
on peut se reporter aux articles~\cite{Rahmani_PRA_97,Rahmani_PRA_01},
mais on peut voir que quand un dipôle s'approche d'une interface alors
ses ondes évanescentes sont captées par l'interface et passées en
propagative d'où l'augmentation de la puissance totale rayonnée quand
le dipôle est très proche de l'interface.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[H]
\begin{center}
  \includegraphics*[width=15.0cm,draft=false]{antenna.eps}
\end{center}
\caption{(a) Configuration: antenne dans le vide au dessus d'une
  interface de permittivité $\varepsilon=20$. (b) Puissance rayonnée
  en fonction de la distance de l'antenne à l'interface. (c) Durée de
  vie d'un atome fluoresecent en fonction de la distance de celui-ci à
  l'interface.}
\label{antenne}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Arbitrary wave}

Dans le cas d'un champ arbitraire celui-ci est défini par
l'utilisateur. C'est à dire que celui-ci doit créer lui même le champ,
et il convient alors de faire ces fichiers en respectant les
conventions choisies par le code. 


La description de la discrétisation du champ incident est faite dans
un fichier qui est demandé quand on clique sur {\it Props}. Par
exemple pour la partie réelle de la composante $x$ du champ il doit
être construit de la manière suivante:

nx,ny,nz 

dx,dy,dz

xmin,ymin,zmin

\begin{itemize}
\item  nx est le nombre de maille suivant l'axe $x$
\item  ny est le nombre de maille suivant l'axe $y$
\item  nz est le nombre de maille suivant l'axe $z$
\item  dx est le pas suivant l'axe $x$
\item  dy est le pas suivant l'axe $y$
\item  dz est le pas suivant l'axe $z$
\item xmin l'abscisse la plus petite
\item ymin l'ordonnée la plus petite
\item zmin la cote la plus petite
\end{itemize}

puis les fichiers du champ électrique sont créés de la manière
suivante pour chacune des composantes du champ partie réelle et
imaginaire séparées:

\vspace{10mm}

open(11, file='Exr.mat', status='new', form='formatted', access='direct', recl=22)

{\bf do} k=1,nz

\hspace{5mm} {\bf do} j=1,ny

\hspace{10mm} {\bf do} i=1,nx 

\hspace{15mm} ii=i+nx*(j-1)+nx*ny*(k-1)

\hspace{15mm} write(11,FMT='(D22.15)',rec=ii) dreal(Ex)

\hspace{10mm} {\bf enddo}

\hspace{5mm} {\bf enddo}

{\bf enddo}

\vspace{10mm}

Attention la maille de discrétisation de l'objet doit être plus grande
que la maille de discrétisation du champ.

